<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8" />
    <title>CSV მონაცემების ძიება</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        input { padding: 8px; width: 300px; font-size: 16px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f4f4f4; }
        #unique-selector { margin-top: 10px; }
    </style>
</head>
<body>

<h2>მონაცემების ძიება CSV ფაილიდან</h2>
<input type="text" id="search" placeholder="სახელი, გვარი, ID..." />
<div id="unique-selector"></div>
<table id="data-table"></table>

<script>
    let data = [];

    async function loadCSV() {
        const response = await fetch('data.csv');
        const text = await response.text();
        const rows = text.trim().split('\n').map(r => r.split(','));

        const headers = rows[0];
        data = rows.slice(1).map(row => {
            const obj = {};
            headers.forEach((h, i) => {
                obj[h.trim()] = (row[i] || "").trim();
            });
            return obj;
        });

        displayTable(data);
    }

    function displayTable(filteredData) {
        const table = document.getElementById('data-table');
        table.innerHTML = '';

        if (filteredData.length === 0) {
            table.innerHTML = '<tr><td colspan="100%">შედეგი არ მოიძებნა</td></tr>';
            return;
        }

        const headers = Object.keys(filteredData[0]);
        const thead = document.createElement('tr');
        headers.forEach(h => {
            const th = document.createElement('th');
            th.textContent = h;
            thead.appendChild(th);
        });
        table.appendChild(thead);

        filteredData.forEach(row => {
            const tr = document.createElement('tr');
            headers.forEach(h => {
                const td = document.createElement('td');
                td.textContent = row[h];
                tr.appendChild(td);
            });
            table.appendChild(tr);
        });
    }

    document.getElementById('search').addEventListener('input', function () {
        const query = this.value.toLowerCase();
        const matches = data.filter(row =>
            Object.values(row).some(val => val.toLowerCase().includes(query))
        );
        displayTable(matches);
    });

    loadCSV();
</script>

</body>
</html>
